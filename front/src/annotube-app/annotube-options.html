<!--
Notification page

By: Mayl
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-spinner/paper-spinner.html">
<link rel="import" href="../components/user-banner.html">
<link rel="import" href="./shared-styles.html">

<dom-module id="annotube-options">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
      }

      label{
        width: 150px;
        display: inline-block;
        vertical-align: top
      }

      br{
        margin:20px;
      }
      paper-button{
        --paper-button: {
          background: darkred;
          color: white;
        };
        --paper-button-ink-color: white;
        margin-top:20px;
  
      }
    </style>

   <div class="card">
     <user-banner 
     pseudo="[[user_pseudo]]" 
     profile-img="[[user_profile_img]]" 
     background-img="[[user_background_img]]"></user-banner>
     <div class= "pd16">
      <h1>Options du compte</h1>
        <paper-spinner id = "spinner" alt="Chargement des paramÃ¨tres" active></paper-spinner>
        <div id="user_infos" hidden>
          <label for= "pseudo">Pseudo</label>
          <span id="pseudo" >[[user_pseudo]]</span>
          <br>
          <label for = "password">Mot de passe</label>
          <input id="password" type="password" name="password" value ="[[user_password]]">
          <br>
          <label for = "email">E-mail</label>
          <input id="email" type="email" name="email" value ="[[user_email]]">
          <br>
          <label for = "description">Description</label>
          <textarea  rows="10" cols="50" id="description" type="text" name="description" value ="[[user_description]]"></textarea>
          <br>
          <label for = "website">Site Web</label>
          <input id="website" type="text" name="website" value ="[[user_website]]">
          <br>
          <label for = "youtube_chanel">Chaine Youtube</label>
          <input id="youtube_chanel" type="text" name="youtube_chanel" value ="[[user_youtube_chanel]]">
          <br>
          <paper-button on-tap="changerNom">Sauvegarder</paper-button>
          <br>
        </div>
     </div>
   
  </template>

  <script>
    Polymer({
      is: 'annotube-options',

      properties: {
        user_pseudo: {
          type: String,
        },
        user_email: {
          type: String,
        },
        user_profile_img: {
          type: String,
        },
        user_website: {
          type: String,
        },
        user_description: {
          type: String,
        },
        user_youtube_chanel: {
          type: String,
        },
        userId:{
          type: String,
          notify: true,
          reflectToAttribute: true,
          observer: '_userIdLoaded'
        },
        user_background_img: {
          type: String,
          value:"http://htmlcolorcodes.com/assets/images/html-color-codes-color-tutorials-hero-00e10b1f.jpg",
        },
      },
      _userIdLoaded : function(){
        var that = this;
        var http = new XMLHttpRequest();
        var url = "https://node.edouardg.fr/user/"+this.userId;

        http.open("GET", url, true);
        http.withCredentials = true;
        http.send();
        http.onreadystatechange = function () {
            if (http.readyState == 4) {
                if (http.status == 200) {
                    var res = JSON.parse(http.response);
                    that.user_pseudo = res.username;
                    that.user_profile_img = "http://www.teflin.org/assets/admin/pages/media/profile/photo3.jpg";
                    that.user_email = res.email;
                    if (res.website){
                      that.user_website= res.website;
                    }
                    if (res.description){
                      that.user_description= res.description;
                    }
                    if (res.youtube_chanel){
                      that.user_youtube_chanel= res.youtube_chanel;
                    }

                    that.$$("paper-spinner").setAttribute("hidden", "true");
                    that.$.user_infos.removeAttribute("hidden");
                }
            }
        };
      }

    });


  </script>
</dom-module>
