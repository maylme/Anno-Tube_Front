<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../bower_components/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../../bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-item/paper-icon-item.html">
<link rel="import" href="../components/annotube-menu.html">

<!-- for routing: -->
<link rel="import" href="../../bower_components/app-route/app-location.html">
<link rel="import" href="../../bower_components/app-route/app-route.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">

<dom-module id="annotube-app">
  <template>
    <style>
      :host {
        display: block;
        --primary-color : darkred;
      }
      paper-header-panel[drawer] {
        --paper-header-panel-container: {
        border-right: 2px solid lightgrey;
        }
      }
       .drawer-list a.iron-selected {
        color: red;
        font-weight: bold;
      }

    </style>

<!-- Utilisé pour le routing, ne pas toucher : -->
<app-location route="{{route}}"></app-location>
<app-route route="{{route}}" pattern="/:page" data="{{routeData}}" tail="{{subroute}}"></app-route>
<!-- End routing -->


<paper-drawer-panel>
  <paper-header-panel drawer>
    <paper-toolbar>
      <div class="title">Menu</div>
    </paper-toolbar>
    <annotube-menu></annotube-menu>
  </paper-header-panel>
  <paper-header-panel main>
    <paper-toolbar>
      <paper-icon-button icon="menu" paper-drawer-toggle></paper-icon-button>
      <div class="title">
        Anno'Tubes
      </div>
    </paper-toolbar>
    <div>
      <!-- Pages à displays selon la route -->
      <iron-pages selected="[[page]]" attr-for-selected="name" fallback-selection="view404" role="main">
        <annotube-home name="home"></annotube-home>
        <!-- there include other views -->
        <annotube-view404 name="view404"></annotube-view404>
      </iron-pages>
    </div>
  </paper-header-panel>
</paper-drawer-panel>



</template>

<script>
  Polymer({

    is: 'annotube-app',

    properties: {
      prop1: {
        type: String,
        value: 'annotube-app',
      },
      page: {
        type: String,
        reflectToAttribute: true,
        observer: '_pageChanged',
      },
    },
    observers: [
      '_routePageChanged(routeData.page)',
    ],

    _routePageChanged: function (page) {
      this.page = page || 'home';

      // if (!this.$.drawer.persistent) {
      //   this.$.drawer.close();
      // }
    },

    _pageChanged: function (page) {
      // Load page import on demand. Show 404 page if fails
      var resolvedPageUrl = this.resolveUrl("annotube-" + page + '.html');
      this.importHref(resolvedPageUrl, null, this._showPage404, true);
    },

    _showPage404: function () {
      this.page = 'view404';
    },



  });
</script>
</dom-module>